let ContaoCookiebar=function(){"use strict";return function(t){let s={},r={},o={selector:".contao-cookiebar",token:"ccb_contao_token",configId:null,pageId:null,version:null,lifetime:63072e3,cookies:null,configs:null,doNotTrack:!1,currentPageId:0,excludedPageIds:null,texts:{acceptAndDisplay:"Accept"},classes:{onSave:"cc-saved",onShow:"cc-active",onGroupToggle:"cc-active",onGroupSplitSelection:"cc-group-half"}};const n=function(e){let t=[],o=e.currentTarget,n=0;o.hasAttribute("data-accept-all")?n=1:o.hasAttribute("data-deny-all")&&(n=2),r.inputs.forEach(function(e){2===n?e.checked=!1:1!==n&&!e.checked||(t.push(parseInt(e.value)),e.checked=!0)}),C({configId:r.settings.configId,pageId:r.settings.pageId,version:r.settings.version,saved:q(),cookies:t}),c(t,!0),a(),l(),O(),t.length&&t.forEach(function(e){r.settings.cookies.hasOwnProperty(e)&&"iframe"===r.settings.cookies[e].type&&b(e),r.modules.hasOwnProperty(e)&&y(e)}),r.dom.classList.add(r.settings.classes.onSave);e=new CustomEvent("cookiebar_save",{detail:{cookiebar:r}});window.dispatchEvent(e),w(!0)},i=function(e){let t=T();-1===t.cookies.indexOf(e)&&(t.cookies.push(parseInt(e)),C(t),r.settings.cookies[e].confirmed=!0,O())},c=function(e,t){let o,n=[];for(o in r.settings.cookies){var c=parseInt(o);if(r.settings.cookies.hasOwnProperty(c)){var s=!!r.settings.cookies[c].confirmed,i=-1!==e.indexOf(c),s=s!=i&&!i;if(r.settings.cookies[c].confirmed=i,!0===t&&s){let e=r.settings.cookies[c].token;null!==e&&e.forEach(function(e){n.push(e)})}}}if(!0===t&&n.length){let e=new XMLHttpRequest;e.open("GET","/cookiebar/delete?"+L({tokens:n}),!0),e.send()}},a=function(){let e;for(e in r.settings.configs)if(r.settings.configs.hasOwnProperty(e)){let o=r.settings.configs[e],n=p(o.cookies);null!==o.resources&&o.resources.forEach(function(e,t){(1===e.mode&&n||2===e.mode&&!n||3===e.mode)&&(g(h(o,t),"config_resource")||d(e))}),null!==o.scripts&&o.scripts.forEach(function(e,t){1===e.mode!==n&&2===e.mode!=!n&&3!==e.mode||g(h(o,t),"config_script")||u(e)})}},l=function(){let e;for(e in r.settings.cookies)if(r.settings.cookies.hasOwnProperty(e)){let o=r.settings.cookies[e];null!==o.resources&&o.resources.forEach(function(e,t){(1===e.mode&&o.confirmed||2===e.mode&&!o.confirmed||3===e.mode)&&(g(h(o,t),"resource")||d(e))}),null!==o.scripts&&o.scripts.forEach(function(e,t){1===e.mode!==o.confirmed&&2===e.mode!=!o.confirmed&&3!==e.mode||g(h(o,t),"script")||u(e)})}},u=function(e){e.script=A(e.script),f(e.script,e.position)},d=function(e){try{let t=document.querySelectorAll("script[src]");var o=P(e.src);for(let e=t.length;e--;)if(-1!==t[e].src.indexOf(o)&&o!==window.location.host)return!1}catch(e){}let t=document.createElement("script");t.type="text/javascript",t.src=e.src,t.onload=()=>{r.loadedResources.push(e.src),v()},null!==e.flags&&e.flags.length&&e.flags.forEach(function(e){"object"==typeof e?t.setAttribute(e[0],e[1]):t[e]=!0}),document.head.append(t)},f=function(e,t){switch(t){case 1:document.body.append(e);break;case 2:document.body.prepend(e);break;case 3:document.head.append(e)}},p=function(e){let t=!1,o;for(o in e)if(r.settings.cookies.hasOwnProperty(o))if(r.settings.cookies[o].confirmed){t=!0;break}return t},g=function(e,t){return r.cache[t]||(r.cache[t]=[]),-1!==r.cache[t].indexOf(e)||(r.cache[t].push(e),!1)},h=function(e,t){return e.id+""+t},m=function(){let e=document.querySelectorAll("a.ccb-trigger, strong.ccb-trigger");e.length&&e.forEach(function(t){t.addEventListener("click",function(e){e.preventDefault(),s.show(t.classList.contains("ccb-prefill"))})})},k=function(){let e=r.dom.querySelectorAll("[data-toggle-cookies]"),t=r.dom.querySelectorAll("[data-toggle-group]"),o=r.dom.querySelectorAll("[data-save],[data-accept-all],[data-deny-all]");o.length&&o.forEach(function(e){e.addEventListener("click",n)}),e.length&&e.forEach(function(e){e.addEventListener("click",S)}),t.length&&t.forEach(function(e){e.addEventListener("click",I)})},y=function(e){let t=document.querySelectorAll('.cc-module[data-ccb-id="'+e+'"]');t&&t.forEach(function(e){e.parentNode.removeChild(e)}),r.modules[e].forEach(function(e){e()}),delete r.modules[e],w()},v=function(){if(!r.resourcesEvents.length)return!1;r.resourcesEvents.forEach(function(e,t){return-1!==r.loadedResources.indexOf(e.src)&&(e.callback(),void delete r.resourcesEvents[t])})},b=function(e){let t=document.querySelectorAll('iframe[data-ccb-id="'+e+'"]');t.length&&t.forEach(function(e){e.src=e.src,e.removeAttribute("data-ccb-id")}),w()},w=function(e){var t=T();let o=[];if(r.show||!0===e){if(t.cookies&&t.cookies.length)o=t.cookies;else if(-1===t.version)for(const n in r.settings.cookies)r.settings.cookies[n].checked&&o.push(n);o.length&&o.forEach(function(e,t){let o=r.dom.querySelector('[id="c'+e+'"]');o&&(o.checked=!0)});let e=r.dom.querySelectorAll('input[name="group[]"]');e&&e.forEach(function(o){if(!o.disabled){o.checked=!1,o.classList.remove(r.settings.classes.onGroupSplitSelection);let e=o.parentElement.querySelectorAll('input[name="cookie[]"]'),t=[];e&&(e.forEach(function(e){e.disabled||t.push(!!e.checked)}),-1===t.indexOf(!1)?o.checked=!0:-1!==t.indexOf(!0)&&-1!==t.indexOf(!1)&&o.classList.add(r.settings.classes.onGroupSplitSelection))}})}},E=function(){r.show?(r.dom.classList.remove(r.settings.classes.onSave),r.dom.classList.add(r.settings.classes.onShow)):r.dom.classList.remove(r.settings.classes.onShow)},S=function(){let o=this.checked,e=this.parentElement.querySelectorAll('input[name="cookie[]"]');e&&e.forEach(function(e,t){e.disabled||(e.checked=o)}),this.classList.remove(r.settings.classes.onGroupSplitSelection)},I=function(){let o=!this.classList.contains(r.settings.classes.onGroupToggle);try{let e=this.parentElement.querySelectorAll(":scope > .toggle-group");e&&e.forEach(function(e,t){e.style.display=o?"block":"none"})}catch(e){let t=this.parentElement.querySelector("[data-toggle-group] ~ .toggle-group");t.style.display=o?"block":"none"}this.classList.toggle(r.settings.classes.onGroupToggle)},O=function(){let e=new XMLHttpRequest;var t={referrer:window.location.pathname,configId:r.settings.configId,pageId:r.settings.pageId,version:r.settings.version,cookies:T().cookies};e.open("GET","/cookiebar/log?"+L(t),!0),e.send()};const L=function(e,t){let o=[],n;for(n in e){var c,s;e.hasOwnProperty(n)&&(c=t?t+"["+n+"]":n,s=e[n],o.push(null!==s&&"object"==typeof s?L(s,c):encodeURIComponent(c)+"="+encodeURIComponent(s)))}return o.join("&")},N=function(){let o={},n=!1,e=0;var t=arguments.length;"[object Boolean]"===Object.prototype.toString.call(arguments[0])&&(n=arguments[0],e++);for(;e<t;e++)!function(e){for(var t in e)Object.prototype.hasOwnProperty.call(e,t)&&(n&&"[object Object]"===Object.prototype.toString.call(e[t])?o[t]=N(!0,o[t],e[t]):o[t]=e[t])}(arguments[e]);return o},x=function(){return r.settings.token+"_"+r.settings.configId},A=function(e){let t=document.createElement("script");return t.type="text/javascript",t.innerHTML=e,t},C=function(e){localStorage.setItem(x(),JSON.stringify(e))},T=function(){let e=localStorage.getItem(x());return null===e?(e={configId:r.settings.configId,pageId:r.settings.pageId,version:-1,saved:-1,cookies:[]},localStorage.setItem(x(),JSON.stringify(e))):e=JSON.parse(e),e},P=function(e){e=e.match(/^https?\:\/\/([^\/?#]+)(?:[\/?#]|$)/i);return e&&e[1]},q=function(){return Math.floor(+new Date/1e3)},j=function(){return!(r.settings.currentPageId&&r.settings.excludedPageIds&&-1!==r.settings.excludedPageIds.indexOf(r.settings.currentPageId))},D=function(){return!r.settings.doNotTrack||(!(window.doNotTrack||navigator.doNotTrack||navigator.msDoNotTrack)||!("1"==window.doNotTrack||"yes"==navigator.doNotTrack||"1"==navigator.doNotTrack||"1"==navigator.msDoNotTrack))},G=function(e){var t=parseInt(e),e=parseInt(r.settings.lifetime);return!isNaN(t)&&-1!==t&&0!==e&&t+e<q()};function e(e,t){t=t||{bubbles:!1,cancelable:!1,detail:void 0};var o=document.createEvent("CustomEvent");return o.initCustomEvent(e,t.bubbles,t.cancelable,t.detail),o}return s.get=function(){return r},s.getStorage=function(){return T()},s.issetCookie=function(e){let t,o=T();if(!o.cookies)return!1;if("number"==typeof e)return-1!==o.cookies.indexOf(e);for(t in r.settings.cookies)if(null!==r.settings.cookies[t].token&&-1!==r.settings.cookies[t].token.indexOf(e))return!0;return-1!==o.cookies.indexOf(e.toString())},s.unblock=function(e,t,o){"iframe"===e.tagName.toLowerCase()?e.src=o:e.tagName.toLowerCase()&&(window.location.href=o),i(t),b(t)},s.addModule=function(o,n,c){var e;if(e=o,n=n,r.modules.hasOwnProperty(e)?r.modules[e].push(n):r.modules[e]=[n],s.issetCookie(o))return y(o),!1;if(c&&"object"==typeof c&&c.selector){let t=null;if(t="string"==typeof c.selector?document.querySelector(c.selector):c.selector,t){let e=document.createElement("div");e.setAttribute("data-ccb-id",o),e.classList.add("cc-module"),c.message&&(e.innerHTML="<p>"+c.message+"</p>"),"object"==typeof c.button&&!0===c.button.show&&((n=document.createElement("button")).innerHTML=c.button.text||r.settings.texts.acceptAndDisplay,n.type=c.button.type||"button",c.button.classes&&(n.className=c.button.classes),n.addEventListener("click",function(){i(o),y(o)}),e.append(n)),t.appendChild(e)}}},s.onResourceLoaded=function(e,t){if(!r.settings.cookies.hasOwnProperty(e))return console.warn(`Cookie ID ${e} does not exists.`),!1;if(!r.settings.cookies[e].resources.length)return console.warn(`The cookie ID ${e} does not contain any resources.`),!1;e=r.settings.cookies[e].resources[0].src;-1!==r.loadedResources.indexOf(e)?t():r.resourcesEvents.push({src:e,callback:t})},s.show=function(e){r.show=!0,E(),e&&w()},s.hide=function(){r.show=!1,E()},window.document.documentMode&&(window.NodeList&&!NodeList.prototype.forEach&&(NodeList.prototype.forEach=Array.prototype.forEach),[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(e){e.hasOwnProperty("append")||Object.defineProperty(e,"append",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),o=document.createDocumentFragment();e.forEach(function(e){var t=e instanceof Node;o.appendChild(t?e:document.createTextNode(String(e)))}),this.appendChild(o)}})}),[Element.prototype,Document.prototype,DocumentFragment.prototype].forEach(function(e){e.hasOwnProperty("prepend")||Object.defineProperty(e,"prepend",{configurable:!0,enumerable:!0,writable:!0,value:function(){var e=Array.prototype.slice.call(arguments),o=document.createDocumentFragment();e.forEach(function(e){var t=e instanceof Node;o.appendChild(t?e:document.createTextNode(String(e)))}),this.insertBefore(o,this.firstChild)}})}),"function"!=typeof window.CustomEvent&&(e.prototype=window.Event.prototype,window.CustomEvent=e)),function(){r.settings=N(!0,o,t),r.dom=document.querySelector(r.settings.selector),r.cache={},r.modules={},r.loadedResources=[],r.resourcesEvents=[],r.show=!1;var e=T();(parseInt(e.version)!==parseInt(r.settings.version)||parseInt(e.configId)!==parseInt(r.settings.configId)||G(e.saved))&&D()&&j()&&(r.show=!0),r.inputs=[],r.dom.querySelectorAll('input[name="cookie[]"]').forEach(function(e,t){e.disabled||r.inputs.push(e)}),k(),m(),c(e.cookies),E(),a(),l(),w();e=new CustomEvent("cookiebar_init",{detail:{visibility:r.show,cookiebar:r}});window.dispatchEvent(e)}(),s}}();